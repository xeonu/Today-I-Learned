# 로그인 방식(쿠키, 세션, JWT)
웹서비스에서 로그인 방식은 크게 **쿠키**, **세션**, **JWT** 3가지 방식으로 구현할 수 있다. 물론 그 외에 OAuth와 같은 방식도 존재한다.

## 쿠키로 구현한 로그인

로그인시 클라이언트 측에서 id와 password를 입력받는다. 클라이언트는 쿠키에 id와 password를 담아 서버에게 전송한다. 서버에는 해당 id와 password가 맞아 로그인이 성공했다는 것을 다시 쿠키로 전송해준다.

이렇게만 봐도 엄청나게 보안에 취약하다는 것을 알 수 있다. 쿠키정보가 탈취되면 바로 사용자 정보가 탈취될 수 있고, 쿠키는 임의로 수정이 가능하기 때문에 누구나 다른 사용자인 것처럼 로그인 할 수 있다.

따라서 쿠키에는 누출되면 안되는 정보를 저장하면 안된다. 즉, 절대로 쿠키를 이용하여 로그인을 구현하면 안된다.

## 세션으로 구현한 로그인
쿠키로 구현한 로그인 방식은 매번 쿠키에 id와 password를 담아서 전송해야했다. 이와 다르게 세션으로 구현한 방식은 서버에서 생성한 JSESSIONID만 담아 전송하고 쿠키가 탈취되었더라도 민감한 정보는 들어있지 않아서 안전하다.

하지만 JSESSIONID를 탈취당하면 다른 사용자인 척 위장할 수 있다. 또 서버에 세션 저장소를 사용해야 하므로 요청이 많아지면 I/O가 많이 발생해 서버 성능에 지장이 생길 수 있다.

## 토큰(JWT)으로 구현한 로그인
쿠키과 세션 로그인 모두 http가 stateful한 상태로 유저정보를 담고 있었다. 이는 http가 지향하는 statless와 상반된다. 클라이언트가 로그인 정보를 서버에게 전달하면 서버는 클라이언트에게 유저 정보를 적절히 암호화하여 토큰을 발급한다. 해당 토큰만 가지고 있으면 서버는 로그인된 클라이언트라는 것을 파악할 수 있다. 

JWT의 내부를 들여다 보면 암호화 방식과 토큰타입을 선언한 **Header**, 사용자 id와 같은 공개되도 지장없는 정보를 담음 **Payload**, 그리고 이 둘을 조합하여 SHA256으로 암호화한 **Verify Signature**로 이루어져 있다. 

SHA256은 단방향 해시함수로 decoding이 불가능하다. 그리고 Header와 Payload를 수정하면 해시값인 Verigy Signature도 변하므로 변조가 어렵다. 불필요하게 세션에서 클라이언트 정보를 조회하지 않아도 되므로 I/O가 줄어든다.